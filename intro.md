# Zentri (脉理) - 本地优先的知识管理工具

> **Trace the logic of your thoughts. / 理清思维的脉络。**

Zentri（脉理）是一款专为研究人员和终身学习者设计的**本地优先（Local-First）**知识管理应用。它采用 **Tauri + Rust** 架构，追求极致性能与数据安全，帮助用户构建个人知识体系，理清思维的脉络。

---

## 🎯 我们想解决什么问题？

在信息爆炸的时代，知识工作者面临诸多挑战：

- **数据安全焦虑**：云端存储让用户担心隐私泄露和数据丢失
- **性能瓶颈**：传统笔记应用在处理大量数据时变得卡顿
- **知识孤岛**：笔记之间缺乏有效连接，难以形成知识网络
- **阅读与写作割裂**：阅读资料和笔记写作分离，影响知识内化效率
- **搜索效率低**：无法快速定位所需信息，特别是中文内容

Zentri 致力于解决这些问题，提供一个**快速、安全、互联**的知识管理解决方案。

---

## ✨ 核心功能

### 📝 Zettelkasten 卡片系统

基于卢曼卡片盒方法，Zentri 提供四种卡片类型，形成完整的知识流转体系：

- **💡 闪念卡片（Fleeting）**：快速捕获灵感，作为思维的临时容器
- **📖 文献卡片（Literature）**：记录阅读笔记，关联原始资料
- **🧠 永久卡片（Permanent）**：经过思考提炼的知识原子，构成知识库核心
- **📋 项目卡片（Project）**：组织长文档和项目笔记，用于产出

卡片之间通过双向链接形成知识网络，支持渐进式结构化，降低使用门槛。

### 📚 数字图书馆

内置强大的文献管理功能：

- **多格式支持**：PDF、EPUB、网页文章、视频等
- **高亮标注**：在阅读时直接标注重要内容
- **拖拽摘录**：从阅读器直接拖拽内容到编辑器，自动生成引用链接
- **回溯定位**：点击笔记中的引用，快速跳回原文位置

### 🔗 WikiLinks 双向链接

使用 `[[笔记标题]]` 语法创建链接，自动建立双向关联：

- **自动补全**：输入时智能提示已有笔记
- **反向链接**：自动显示哪些笔记链接到当前笔记
- **图谱可视化**：直观展示知识网络结构

### 🕸️ 知识图谱

基于 PageRank 算法的知识图谱可视化：

- **关系发现**：自动发现笔记之间的关联
- **重要性排序**：根据连接度识别核心概念
- **交互探索**：点击节点快速跳转，拖拽调整布局
- **高性能渲染**：支持万级节点流畅展示

### 🎨 Canvas 模式

无限画布空间组织：

- **自由布局**：在画布上自由放置和连接卡片
- **视觉思维**：适合头脑风暴和概念映射
- **多画布管理**：为不同主题创建独立画布

### 🔍 全文搜索

毫秒级全文检索：

- **中文分词**：集成 Jieba 分词，支持中文内容精准搜索
- **增量索引**：只索引变更文件，启动速度极快
- **高亮显示**：搜索结果中高亮匹配关键词
- **多条件筛选**：按类型、标签、日期等组合搜索

### 📅 每日笔记

快速捕获系统：

- **自动创建**：每天自动生成日记页面
- **万能收件箱**：作为临时想法的收集容器
- **日期导航**：快速访问历史日记

### 🏠 本地优先架构

数据完全掌控在用户手中：

- **透明存储**：所有数据以 JSON 文件形式存储，用户可直接访问
- **无云端依赖**：完全离线工作，保护隐私
- **原子写入**：采用原子操作保证数据不丢失
- **文件监听**：实时同步外部文件修改

---

## 🛠️ 技术架构

### 前端技术栈

| 技术 | 用途 |
|------|------|
| **React 19** | 现代化 UI 框架 |
| **TypeScript** | 类型安全的开发体验 |
| **TailwindCSS 4** | 原子化 CSS，快速构建界面 |
| **TipTap / ProseMirror** | 可扩展的富文本编辑器 |
| **Zustand** | 轻量级状态管理 |
| **React Router** | 单页应用路由 |
| **@xyflow/react** | 图谱可视化 |
| **pdf.js / epub.js** | PDF 和 EPUB 阅读器 |

### 后端技术栈

| 技术 | 用途 |
|------|------|
| **Tauri 2.0** | 跨平台桌面应用框架 |
| **Rust** | 高性能系统编程语言 |
| **SQLite (rusqlite)** | 轻量级关系数据库，存储元数据 |
| **Tantivy** | Rust 原生全文检索引擎 |
| **Jieba-rs** | 中文分词库 |
| **Petgraph** | 图算法库，用于知识图谱计算 |
| **Notify** | 文件系统监听 |
| **Yrs** | CRDT 协作编辑支持（未来） |

### 架构特点

1. **分层设计**
   - UI 层：React 组件
   - 状态层：Zustand Store
   - 服务层：API 调用封装
   - 命令层：Tauri IPC
   - 业务层：Rust 核心逻辑
   - 数据层：文件系统 + SQLite + 搜索索引

2. **性能优化**
   - **增量索引**：只索引变更文件，避免全量扫描
   - **原子写入**：保证数据一致性，防止文件损坏
   - **异步处理**：搜索和索引在独立线程中运行，不阻塞 UI
   - **WebGL 渲染**：大规模图谱使用 GPU 加速渲染

3. **数据安全**
   - **本地存储**：所有数据存储在用户指定的 Vault 目录
   - **原子操作**：写入操作保证原子性，避免数据丢失
   - **文件监听**：实时检测外部修改，防止数据冲突

---

## 🚀 技术亮点

### 1. 原子写入机制

采用临时文件 + 原子替换的方式，确保即使在写入过程中程序崩溃，也不会产生损坏的文件：

```rust
// 伪代码示例
fn atomic_save(path: &Path, content: &str) -> Result<()> {
    let tmp_path = path.with_extension("md.tmp");
    fs::write(&tmp_path, content)?;  // 先写入临时文件
    fs::rename(&tmp_path, path)?;    // 原子替换（操作系统保证）
    Ok(())
}
```

### 2. 增量索引策略

通过 Hash 校验和文件监听，实现高效的增量索引：

- 启动时对比文件修改时间，只索引变更文件
- 运行时监听文件系统事件，实时更新索引
- 避免每次启动全量扫描，大幅提升启动速度

### 3. 高性能图谱渲染

- **Rust 计算布局**：在 Rust 端计算节点坐标，避免阻塞 JavaScript 主线程
- **WebGL 渲染**：使用 GPU 加速，支持万级节点流畅展示
- **PageRank 算法**：自动识别知识网络中的核心节点

### 4. 自定义编辑器节点

在 ProseMirror 中实现自定义引用节点，支持：

- **拖拽摘录**：从阅读器拖拽内容到编辑器
- **动态引用**：引用内容与原文保持关联
- **自动更新**：原文修改时自动更新引用显示

---

## 📊 性能表现

- **启动时间**：< 1 秒（增量索引）
- **搜索响应**：< 50ms（万级文档）
- **图谱渲染**：60fps（千级节点）
- **内存占用**：< 100MB（典型使用场景）
- **应用体积**：< 20MB（跨平台）

---

## 🎯 适用场景

- **学术研究**：管理文献、整理思路、构建知识体系
- **知识工作者**：建立个人知识库，积累专业知识
- **终身学习者**：记录学习笔记，形成知识网络
- **创作者**：收集素材、组织想法、产出内容

---

## 🔮 未来规划

### Phase 1: 极速工作台（当前阶段）
- ✅ 双面板编辑器
- ✅ Markdown 渲染
- ✅ 卡片流转体系
- ✅ 全文搜索

### Phase 2: 深度阅读器（进行中）
- ✅ 内置 PDF/EPUB 阅读器
- 🔄 拖拽式摘录优化
- 🔄 摘录回溯功能

### Phase 3: 费曼 AI 教练（规划中）
- 📋 接入本地 LLM
- 📋 费曼模式（AI 提问）
- 📋 向量语义检索

---

## 💡 设计理念

1. **本地优先**：用户数据完全掌控，无需担心隐私和依赖
2. **性能至上**：即使在数据量庞大的情况下，依然保持流畅体验
3. **渐进式结构化**：降低使用门槛，让知识自然生长
4. **互联互通**：通过双向链接和知识图谱，让知识形成网络
5. **工具先行，AI 殿后**：先建立稳定的工具基础，再引入 AI 能力

---

## 🤝 开源与贡献

Zentri 采用 MIT 许可证，欢迎社区贡献。无论是功能建议、Bug 报告还是代码贡献，都是我们前进的动力。

---

## 📄 许可证

MIT License - 详见 [LICENSE](LICENSE) 文件

---

<p align="center">
  <strong>Built with ❤️ using Tauri, React, and Rust</strong>
</p>




